<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>مولّد نمط الرهانات</title>

  <style>
    :root{
      --bg:#071427;
      --panel:#0f1724;
      --accent:#18a0fb;
      --muted:#9fb0c9;
      --badge-bg:rgba(24,160,251,0.12);
    }

    html,body{
      margin:0;
      height:100%;
      background:#071427;
      color:#e6eef8;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
      -webkit-font-smoothing:antialiased;
    }

    .wrap{
      min-height:100%;
      display:flex;
      justify-content:center;
      padding:16px;
    }

    .panel{
      width:100%;
      max-width:420px;
      background:#0f1724;
      border-radius:16px;
      padding:18px 16px 20px;
      box-shadow:0 10px 40px rgba(0,0,0,.7);
    }

    h1{
      margin:0;
      font-size:19px;
      color:var(--accent);
    }

    .subtitle{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
      line-height:1.5;
    }

    .controls{
      margin-top:16px;
      display:flex;
      gap:10px;
      align-items:flex-end;
      flex-wrap:wrap;
    }

    label{
      font-size:13px;
      font-weight:600;
      color:var(--muted);
      margin-bottom:4px;
    }

    input[type=number]{
      padding:11px 10px;
      border-radius:10px;
      background:var(--panel);
      border:1px solid rgba(255,255,255,.06);
      color:#e5e7eb;
      font-weight:600;
      width:140px;
      font-size:14px;
    }

    input:focus{
      outline:none;
      box-shadow:0 0 0 1px var(--accent);
    }

    .btn{
      padding:12px 16px;
      border:none;
      border-radius:12px;
      background:linear-gradient(180deg,var(--accent),#0b84d6);
      color:#042129;
      font-weight:700;
      cursor:pointer;
      font-size:15px;
      width:100%;
    }

    .btn:active{transform:translateY(1px)}

    .output{
      margin-top:18px;
      padding:14px 10px 6px;
      border-radius:14px;
      background:rgba(255,255,255,0.02);
      display:none;
    }

    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .item{
      padding:10px 12px;
      border-radius:12px;
      background:rgba(255,255,255,0.03);
      border:1px solid rgba(255,255,255,0.05);
      display:flex;
      justify-content:space-between;
      align-items:center;
    }

    .label{
      font-size:15px;
      font-weight:800;
      color:#ffffff;
    }

    .meta{
      font-size:13px;
      color:#dbeafe;
      font-weight:700;
      background:var(--badge-bg);
      border-radius:999px;
      padding:4px 10px;
      white-space:nowrap;
    }

    .footer{
      text-align:center;
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
    }

    @media (max-width:600px){
      .wrap{padding:12px}
      .panel{padding:16px 14px 18px}
      h1{font-size:18px}
      .controls{flex-direction:column;align-items:stretch}
      input[type=number]{width:100%}
      .btn{width:100%;font-size:16px;padding:13px 16px}
      .item{padding:10px}
      .label{font-size:15px}
      .meta{font-size:13px}
    }
  </style>
</head>

<body>
<div class="wrap">
  <div class="panel">
    <h1>مولّد نمط الرهانات</h1>
    <div class="subtitle">
      مبالغ عشوائية وعدد لفّات متغيّر. إذا كان إجمالي الرهان أكبر من 15 درهم، تكون هناك لفّة واحدة فقط.
    </div>

    <div class="controls">
      <div style="display:flex;flex-direction:column;width:100%">
        <label for="budget">الميزانية (MAD)</label>
        <input id="budget" type="number" value="50" min="5">
      </div>
      <button id="gen" class="btn">الحصول على الإستراتيجية</button>
    </div>

    <div id="output" class="output">
      <div id="list" class="list"></div>
      <div id="footer" class="footer"></div>
    </div>
  </div>
</div>

<script>
(function(){

  function randomUnique5(){
    const s = new Set();
    while (s.size < 5){
      s.add(Math.floor(Math.random()*100) + 10);
    }
    return Array.from(s);
  }

  function computePattern(budget){
    let raw = randomUnique5();
    let sumRaw = raw.reduce((a,b)=>a+b,0);

    // масштабируем под бюджет
    let scaled = raw.map(v => v / sumRaw * budget);

    // округляем
    let rounded = scaled.map(v => Math.floor(v));
    let diff = budget - rounded.reduce((a,b)=>a+b,0);

    // раскидываем остаток
    while (diff > 0){
      let i = Math.floor(Math.random()*5);
      rounded[i]++;
      diff--;
    }

    // делаем значения уникальными
    let used = new Set();
    for (let i=0;i<5;i++){
      while (used.has(rounded[i])){
        rounded[i]++;
      }
      used.add(rounded[i]);
    }

    // перемешиваем, чтобы не было ощущения сортировки
    for (let i = rounded.length - 1; i > 0; i--){
      const j = Math.floor(Math.random() * (i + 1));
      [rounded[i], rounded[j]] = [rounded[j], rounded[i]];
    }

    return rounded;
  }

  function generateSpins(sum){
    if (sum > 15) return 1;
    return Math.floor(Math.random()*6) + 2; // 2–7
  }

  function render(pattern, budget){
    const list = document.getElementById("list");
    const out = document.getElementById("output");
    const footer = document.getElementById("footer");

    list.innerHTML = "";

    for (let i=0;i<5;i++){
      const total = pattern[i];
      const spins = generateSpins(total);

      const div = document.createElement("div");
      div.className = "item";

      const label = document.createElement("div");
      label.className = "label";
      label.textContent = `إجمالي الرهان: ${total} MAD`;

      const meta = document.createElement("div");
      meta.className = "meta";
      meta.textContent = `عدد اللفات: ${spins}`;

      div.appendChild(label);
      div.appendChild(meta);
      list.appendChild(div);
    }

    footer.textContent = `الإجمالي: ${pattern.reduce((a,b)=>a+b,0)} MAD — الميزانية: ${budget} MAD`;
    out.style.display = "block";
  }

  document.getElementById("gen").addEventListener("click", () => {
    const budget = parseInt(document.getElementById("budget").value) || 0;
    if (budget <= 0){
      alert("أدخل ميزانية صحيحة من فضلك");
      return;
    }
    const pattern = computePattern(budget);
    render(pattern, budget);
  });

})();
</script>
</body>
</html>
