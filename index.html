<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Генератор паттерна ставок</title>
<style>
:root{
  --bg:#071427; --panel:#0f1724; --accent:#18a0fb; --muted:#9fb0c9;
}
html,body{margin:0;height:100%;background:#071427;color:#e6eef8;font-family:Inter,system-ui;-webkit-font-smoothing:antialiased}
.wrap{min-height:100%;display:flex;justify-content:center;padding:20px}
.panel{width:100%;max-width:820px;background:#0f1724;border-radius:14px;padding:22px;box-shadow:0 10px 40px rgba(0,0,0,.6)}
h1{margin:0;color:var(--accent);font-size:20px}
.subtitle{font-size:13px;color:var(--muted);margin-top:4px}

.controls{margin-top:16px;display:flex;gap:12px;align-items:center}
label{font-weight:600;color:var(--muted)}
input[type=number]{padding:10px;border-radius:8px;background:var(--panel);border:1px solid rgba(255,255,255,.05);color:#cbd5e1;font-weight:600;width:160px}
.btn{padding:12px 16px;border:none;border-radius:10px;background:linear-gradient(180deg,var(--accent),#0b84d6);color:#042129;font-weight:700;cursor:pointer}
.btn.secondary{background:transparent;border:1px solid rgba(255,255,255,.06);color:var(--muted)}

.output{margin-top:18px;padding:18px;border-radius:12px;background:rgba(255,255,255,0.02);display:none}
.list{display:flex;flex-direction:column;gap:12px}
.item{padding:12px 16px;border-radius:10px;background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);display:flex;justify-content:space-between}
.label{font-size:17px;font-weight:800;color:white}
.meta{color:var(--muted);font-family:monospace}

.footer{text-align:center;color:var(--muted);margin-top:12px;font-size:13px}

@media(max-width:600px){
  .controls{flex-direction:column;align-items:stretch}
  input[type=number], .btn{width:100%}
}
</style>
</head>

<body>
<div class="wrap">
  <div class="panel">
    <h1>Генератор паттерна ставок — Technical</h1>
    <div class="subtitle">5 неубывающих ставок. Каждая = ставка × количество повторов. Сумма всех = бюджету.</div>

    <div class="controls">
      <div style="display:flex;flex-direction:column;gap:6px">
        <label>Бюджет (MAD)</label>
        <input id="budget" type="number" value="50" min="5">
      </div>

      <button id="gen" class="btn">Получить стратегию</button>
    </div>

    <div id="output" class="output">
      <div id="list" class="list"></div>
      <div id="footer" class="footer"></div>
    </div>
  </div>
</div>

<script>
(function(){
  const repeats = [5,3,4,2,5]; // количество прокрутов
  const weights = [1,2,1,2,4]; // веса для распределения *per-spin*

  function computePattern(budget){
    // 1) сумма всех (вес × рет)
    const weighted = weights.map((w,i)=>w*repeats[i]);
    const sumWeighted = weighted.reduce((a,b)=>a+b,0);

    // 2) рассчитываем сумму строки (final = perSpin × ret)
    let rowSum = weighted.map(w => (budget * w) / sumWeighted);

    // 3) округление вниз + перераспределение остатка
    let rounded = rowSum.map(v=>Math.floor(v));
    let diff = budget - rounded.reduce((a,b)=>a+b,0);
    while(diff>0){
      const idx = Math.floor(Math.random()*rounded.length);
      rounded[idx]++; diff--;
    }

    // 4) обеспечиваем неубывающую последовательность
    for(let i=1;i<5;i++){
      if(rounded[i] < rounded[i-1]){
        const need = rounded[i-1] - rounded[i];
        rounded[i] += need;
        rounded[4] = Math.max(rounded[4] - need, 0);
      }
    }

    // 5) вычисляем ставку per-spin
    const perSpin = rounded.map((sum,i)=> Math.max(1, Math.floor(sum / repeats[i])));

    // финальная проверка
    return perSpin.map((ps,i)=> ps * repeats[i]);
  }

  function render(pattern, budget){
    const out = document.getElementById("output");
    const list = document.getElementById("list");
    const footer = document.getElementById("footer");

    list.innerHTML = "";
    for(let i=0;i<5;i++){
      const div = document.createElement("div");
      div.className="item";

      const label = document.createElement("div");
      label.className="label";
      label.innerText = `Общая ставка: ${pattern[i]} MAD`;

      const meta = document.createElement("div");
      meta.className="meta";
      meta.innerText = `${repeats[i]} рет`;

      div.appendChild(label);
      div.appendChild(meta);
      list.appendChild(div);
    }

    footer.innerText = `Итого: ${pattern.reduce((a,b)=>a+b,0)} MAD — бюджет: ${budget} MAD`;
    out.style.display = "block";
  }

  document.getElementById("gen").addEventListener("click", ()=>{
    const budget = parseInt(document.getElementById("budget").value)||0;
    if(budget<=0) return alert("Введите корректный бюджет");

    const pattern = computePattern(budget);
    render(pattern, budget);
  });

})();
</script>

</body>
</html>
